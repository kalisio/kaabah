<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>kaabah</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/2.styles.4ffff1ae.css" as="style"><link rel="preload" href="/assets/js/app.185eb4db.js" as="script"><link rel="preload" href="/assets/js/0.11c41d19.js" as="script"><link rel="prefetch" href="/assets/js/1.cd9f1b62.js">
    <link rel="stylesheet" href="/assets/css/2.styles.4ffff1ae.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><!----></div><div class="page"><div class="content"><h1 id="kaabah"><a href="#kaabah" aria-hidden="true" class="header-anchor">#</a> kaabah</h1><h2 id="what-is-it"><a href="#what-is-it" aria-hidden="true" class="header-anchor">#</a> What is it ?</h2><p><b>Kaabah</b> is a <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> based solution to create and manage a <a href="https://docs.docker.com/engine/swarm/" target="_blank" rel="noopener noreferrer">Docker Swarm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> infrastructure either on <a href="https://www.scaleway.com/" target="_blank" rel="noopener noreferrer">Scaleway<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or on <a href="https://aws.amazon.com" target="_blank" rel="noopener noreferrer">AWS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> bootstrapped with high level services such. This bouquet of services includes <a href="https://traefik.io/" target="_blank" rel="noopener noreferrer">traefik<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://portainer.io/" target="_blank" rel="noopener noreferrer">portainer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">prometheus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">grafana<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in order to help you operate your cluster easily.</p><p><img src="/assets/img/kaabah-overview.e8d8ef98.svg" alt="Kaabah overview"></p><blockquote><p>The Kaabah project was initiated by Kalisio to provide us with the necessary tools to manage the different infrastructures we need to support our development.<br><br><a href="https://kalisio.com" target="_blank" rel="noopener noreferrer"><img src="data:image/png;base64,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" alt="kalisio"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br><i>Unleashing the potential of spatial information</i></p></blockquote><h2 id="how-does-it-work"><a href="#how-does-it-work" aria-hidden="true" class="header-anchor">#</a> How does it work ?</h2><h3 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h3><p>The overall approach is based on the use of Terraform Workspaces. As a reminder, a Workspace  is a collection of everything Terraform needs to run: a configuration of your infrastructure (i.e. <b>kaabah</b>), values for that configuration's variables, and state data to keep track of operations. Therefore a Workplace could be considered as an instance of the the infrastructure with its own environment. Follow this <a href="https://www.terraform.io/docs/enterprise/guides/recommended-practices/part1.html#the-recommended-terraform-workspace-structure" target="_blank" rel="noopener noreferrer">link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to read more about Terraform Workspaces and best practices.</p><p>Starting from this premise, <b>Kaabah</b> allows you to manage as many clusters as your projects require and stores their states in a bucket on Amazon S3. Moreover, you have the capability to use Scaleway or AWS to host your infrastructure. Assuming, we name the our workspaces with both the project name and its environment (i.e. dev, test...), we can sketch the following diagram to illustrate the overall functioning of <b>Kaabah</b></p><p><img src="/assets/img/kaabah-terraform.555a6e18.svg" alt="Kaabah terraform"></p><h3 id="terraform-configuration"><a href="#terraform-configuration" aria-hidden="true" class="header-anchor">#</a> Terraform configuration</h3><p>The Terraform configuration is composed of 2 modules:</p><ul><li>the <b>AWS</b> module which has the responsibility to create the Docker Swarm infrastructure on AWS</li><li>the <b>Scaleway</b> module has the responsibility to create the Docker Swarm infrastructure on Scaleway</li></ul><p>And it exposes the following variables:</p><table><thead><tr><th>Variables</th><th>Description</th></tr></thead><tbody><tr><td><code>SCALEWAY_ACCESS_KEY</code></td><td>Your Scaleway access key</td></tr><tr><td><code>SCALEWAY_TOKEN</code></td><td>Your Scaleway token</td></tr><tr><td><code>AWS_ACCESS_KEY</code></td><td>Your AWS access key. This is important to note that your credential must allows access to AWS EC2 and S3 services</td></tr><tr><td><code>AWS_SECRET_KEY</code></td><td>Your AWS secret key</td></tr><tr><td><code>AUTH_USER</code></td><td>Your authentication identity to access the services</td></tr><tr><td><code>AUTH_PASSWORD</code></td><td>Your authentication password to access the services. It must be encrypted and for now only <b>SHA1</b> encryption is supported</td></tr><tr><td><code>provider</code></td><td>The provider to host the infrastructure. It must be <code>AWS</code> or <code>Scaleway</code>. The default value is <code>Scaleway</code></td></tr><tr><td><code>domain</code></td><td>The domain to be added to the traefik rules. The default value is <code>kalisio.xyz</code></td></tr><tr><td><code>subdomain</code></td><td>The subdomain to be added to the traefik rules. By default, the value will be computed from the Terraform workspace name by replacing each <code>-</code> by <code>.</code> (i.e. the output of <code>app-dev</code> will be <code>app.dev</code>).</td></tr><tr><td><code>ca_server</code></td><td>The Let's Encrypt server to generate certificates. The default value is empty to let traefik manage for you. However and because Let's Encrypt provides <a href="https://letsencrypt.org/docs/rate-limits/" target="_blank" rel="noopener noreferrer">rate limits<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> it is recommended to set this value to <code>https://acme-staging-v02.api.letsencrypt.org/directory</code> when testing your infrastructure.</td></tr><tr><td><code>contact</code></td><td>The email contact provided to Let's Encrypt when generating certificates. The default value is <code>contact@kalisio.com</code></td></tr><tr><td><code>docker_version</code></td><td>The version of the Docker engine to be installed. The default value is <code>18.03.1~ce-0~ubuntu</code></td></tr><tr><td><code>manager_instance_type</code></td><td>The instance type of the Docker Swarm manager. It must be a X86 64bits architecture and it depends on the provider. The default value is <code>START1-S</code></td></tr><tr><td><code>worker_instance_type</code></td><td>The instance type of the Docker Swarm workers. It must be a X86 64bits architecture and it depends on the provider. The default value is <code>START1-S</code></td></tr><tr><td><code>worker_instance_count</code></td><td>The number of worker instances. The default value is <code>1</code></td></tr><tr><td><code>ssh_key</code></td><td>The path to the the ssh key required to get connected to the instances. The default value is <code>secrets/kalisio.pem</code></td></tr><tr><td><code>key_name</code></td><td>The AWS name of the ssh key to be used when creating the instance. The default value is <code>kalisio</code></td></tr></tbody></table><p>These variables can be overridden to match your environment requirements. See the section [How to use it ?](## How to use it ?)</p><h3 id="docker-swarm"><a href="#docker-swarm" aria-hidden="true" class="header-anchor">#</a> Docker Swarm</h3><p><b>Kaabah</b> provides the Terraform and Docker configuration to create and manage a Docker Swarm with a stack of high level services that allows you to:</p><ul><li>route the traffic to the cluster and ensure SSL termination using <a href="https://traefik.io/" target="_blank" rel="noopener noreferrer">traefik<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>manage the services deployed on the cluster using <a href="https://portainer.io/" target="_blank" rel="noopener noreferrer">portainer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>monitor the cluster using <a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">prometheus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>analyze the cluster metrics using <a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">grafana<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>share files among the nodes of the cluster using <a href="https://github.com/vieux/docker-volume-sshfs" target="_blank" rel="noopener noreferrer">Docker volume plugin for sshfs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p>The following diagram illustrates a Swarm cluster composed of 4 nodes including a <b>manager</b> and 3 <b>workers</b> and the corresponding stack of services.</p><p><img src="/assets/img/kaabah-swarm.d67d6932.svg" alt="swarm concept"></p><p>The instances are named according the following convention:</p><ul><li><code>&lt;WORKSAPCE&gt;-manager</code></li><li><code>&lt;WORKSAPCE&gt;-woker-&lt;INDEX&gt;</code></li></ul><h3 id="traefik"><a href="#traefik" aria-hidden="true" class="header-anchor">#</a> traefik</h3><p><b>traefik</b> allows to route the traffic from internet to the Docker Swarm infrastructure with SSL termination. It uses <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let's Encrypt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to generate and renew SSL certificates for each services.</p><blockquote><p>Du to rate limits fixed by Let's Encrypt, it is highly recommend to set the <code>ca_server</code> to <code>https://acme-staging-v02.api.letsencrypt.org/directory</code> when testing your infrastructure.</p></blockquote><p>By default, <b>Kabbah</b> specializes the <b>traefik</b> configuration with:</p><ul><li>2 entrypoints:
<ul><li>to allow HTTPS requests</li><li>to allow and redirect HTTP request to HTTPS</li></ul></li><li>5 frontends to access the services:
<ul><li><b>traefik (ui)</b></li><li><b>portainer</b>,</li><li><b>prometheus</b></li><li><b>alertmanager</b></li><li><b>grafana</b>.
The frontend rules depend on the <code>subdomain</code> and <code>donain</code> variables defined in the Terraform configuration.</li></ul></li></ul><p>It also support basic authentication to access the services using the variables <code>AUTH_USER</code> and <code>AUTH_PASSWORD</code>. This means that <b>portainer</b> and <b>grafana</b> authentication have been disabled.</p><p>Considering a Terraform workspace named <code>app-dev</code>, the default subdomain will be <code>app.dev</code>and the <b>traefik</b> configuration will be as the following diagram:</p><p><img src="/assets/img/kaabah-traefik.96292850.svg" alt="traefik routing"></p><h2 id="how-to-use-it"><a href="#how-to-use-it" aria-hidden="true" class="header-anchor">#</a> How to use it ?</h2><h3 id="installation"><a href="#installation" aria-hidden="true" class="header-anchor">#</a> Installation</h3><h4 id="clone-the-github-repository"><a href="#clone-the-github-repository" aria-hidden="true" class="header-anchor">#</a> Clone the Github repository</h4><div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">git</span> clone https://github.com/kalisio/kaabah.git
$ <span class="token function">cd</span> kaabah
</code></pre></div><h4 id="setup-your-terraform-environment"><a href="#setup-your-terraform-environment" aria-hidden="true" class="header-anchor">#</a> Setup your Terraform environment</h4><ol><li>Define your Scaleway credentials</li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token variable">$export</span> TF_VAR_SCALEWAY_ACCESS_KEY<span class="token operator">=</span><span class="token string">&quot;&lt;ACCESS-KEY&gt;&quot;</span>
<span class="token variable">$export</span> TF_VAR_SCALEWAY_TOKEN<span class="token operator">=</span><span class="token string">&quot;&lt;ACCESS-TOKEN&gt;&quot;</span> 
</code></pre></div><ol start="2"><li>Define your AWS credentials</li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token variable">$export</span> TF_VAR_AWS_ACCESS_KEY<span class="token operator">=</span><span class="token string">&quot;&lt;ACCESS-KEY&gt;&quot;</span>
<span class="token variable">$export</span> TF_VAR_AWS_SECRET_KEY<span class="token operator">=</span><span class="token string">&quot;&lt;SECRET-KEY&gt;&quot;</span> 
</code></pre></div><ol start="3"><li>Define your authentication parameters</li></ol><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token variable">$export</span> TF_VAR_KAABAH_AUTH_USER<span class="token operator">=</span><span class="token string">&quot;&lt;AUTH_USER&gt;&quot;</span>
<span class="token variable">$export</span> TF_VAR_KAABAH_AUTH_PASSWORD<span class="token operator">=</span><span class="token string">&quot;&lt;ENCRYPTED_AUTH_PASSWORD&gt;&quot;</span>
</code></pre></div><ol start="4"><li>Define the <a href="https://www.terraform.io/docs/backends/types/s3.html" target="_blank" rel="noopener noreferrer">S3 backend<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> properties</li></ol><p>Create a file <code>backend.config</code> with the following properties:</p><div class="language- extra-class"><pre class="language-text"><code>bucket = &quot;the name of the bucket&quot;
region = &quot;the region of the bucket&quot;
key    = &quot;the key to the states&quot;
</code></pre></div><ol start="5"><li>Initialize Terraform</li></ol><div class="language-bash extra-class"><pre class="language-bash"><code>$ terraform init -backend-config<span class="token operator">=</span><span class="token string">&quot;path/to/your/backend.config&quot;</span>
</code></pre></div><h3 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h3><h4 id="create-a-workspace"><a href="#create-a-workspace" aria-hidden="true" class="header-anchor">#</a> Create a workspace</h4><div class="language-bash extra-class"><pre class="language-bash"><code>terraform workspace new app-dev
</code></pre></div><p>Terraform will automatically switch to the created workspace <code>my-test</code></p><h4 id="configure-the-workspace"><a href="#configure-the-workspace" aria-hidden="true" class="header-anchor">#</a> Configure the workspace</h4><p>We recommend to create a <code>tfvars</code> file to override the default variables for your workspace. For instance, the <code>app-dev.tfvars</code> file may look like this:</p><div class="language- extra-class"><pre class="language-text"><code>provider = &quot;SCALEWAY&quot;

manager_instance_type = &quot;START1-S&quot;

worker_instance_type = &quot;START1-S&quot;

worker_instance_count = 2

ca_server = &quot;https://acme-staging-v02.api.letsencrypt.org/directory&quot;
</code></pre></div><h4 id="apply-the-changes"><a href="#apply-the-changes" aria-hidden="true" class="header-anchor">#</a> Apply the changes</h4><p>Within your workspace, apply Terraform with your specific configuration:</p><div class="language- extra-class"><pre class="language-text"><code>terraform apply -var-file app-dev.tfvars
</code></pre></div><p>After a while, your cluster should be created and the corresponding Terraform states stored in your S3 backend.</p><h4 id="check-the-infrastructure"><a href="#check-the-infrastructure" aria-hidden="true" class="header-anchor">#</a> Check the infrastructure</h4><p>Get connected to the manager of your infrastructure using <code>ssh</code> and type the following commands:</p><div class="language-bash extra-class"><pre class="language-bash"><code>root@app-dev-manager:~<span class="token comment"># docker node ls</span>
ID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION
rwwms640br7eworemnzm71kas *   app-dev-manager    Ready               Active              Leader              18.03.1-ce
cncd3bj11drznaih0zgsxoi2y     app-dev-worker-1   Ready               Active                                  18.03.1-ce
4fup9ac9pklv5h81v0o99w40h     app-dev-worker-2   Ready               Active                                  18.03.1-ce
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code>root@app-dev-manager:~<span class="token comment"># docker service ls</span>
ID                  NAME                         MODE                REPLICAS            IMAGE                           PORTS
jwyzwgo2mjyb        services_alertmanager        replicated          1/1                 prom/alertmanager:latest
a35bnom5voa1        services_blackbox-exporter   replicated          1/1                 prom/blackbox-exporter:latest
sr7c26casj5o        services_cadvisor            global              3/3                 google/cadvisor:latest          *:8081-<span class="token operator">&gt;</span>8080/tcp
yp94tsujdftq        services_grafana             replicated          1/1                 grafana/grafana:latest
jql9o8nawlkm        services_node-exporter       global              3/3                 prom/node-exporter:latest
0jl7slbb6tll        services_portainer           replicated          1/1                 portainer/portainer:latest
hgeulxbwkex2        services_prometheus          replicated          1/1                 prom/prometheus:latest
ltstocwymexj        services_traefik             replicated          1/1                 traefik:latest
</code></pre></div><h4 id="deploy-your-application"><a href="#deploy-your-application" aria-hidden="true" class="header-anchor">#</a> Deploy your application</h4><p>TODO</p></div><div class="content edit-link"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/0.11c41d19.js" defer></script><script src="/assets/js/app.185eb4db.js" defer></script>
  </body>
</html>
